<div class="page">
  <h2 class="page__title fz-2 my-2">{{ "Reports" | translate }}</h2>

  <div class="is-flex is-justify-content-space-between my-2">
    <div class="filters">
      <form [formGroup]="form">
        <mat-form-field appearance="fill" class="dropdown-width mr-1">
          <mat-label>{{ "DealType" | translate }}</mat-label>
          <mat-select formControlName="dealType">
            <mat-option
              *ngFor="let dealType of dealTypes"
              [value]="dealType.value"
            >
              {{ dealType.value | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>{{ "DateRange" | translate }}</mat-label>
          <mat-date-range-input
            [formGroup]="range"
            [rangePicker]="picker"
            [disabled]="true"
          >
            <input
              matStartDate
              formControlName="start"
              placeholder="{{ 'Start' | translate }}"
            />
            <input
              matEndDate
              formControlName="end"
              placeholder="{{ 'End' | translate }}"
            />
          </mat-date-range-input>
          <mat-datepicker-toggle
            matIconSuffix
            [for]="picker"
            [disabled]="false"
          ></mat-datepicker-toggle>
          <mat-date-range-picker
            #picker
            [disabled]="false"
          ></mat-date-range-picker>

          <mat-error
            *ngIf="range.controls.start.hasError('matStartDateInvalid')"
            >Invalid start date</mat-error
          >
          <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')"
            >Invalid end date</mat-error
          >
        </mat-form-field>
        <button
          mat-stroked-button
          color="primary"
          class="mx-1"
          [disabled]="
            !form.get('dealType')?.value &&
            !range.get('start')?.value &&
            !range.get('end')?.value
          "
          (click)="applyFilter()"
        >
          <mat-icon>autorenew</mat-icon> {{ "Apply" | translate }}
        </button>
        <button
          mat-stroked-button
          color="warn"
          [disabled]="
            !form.get('dealType')?.value &&
            !range.get('start')?.value &&
            !range.get('end')?.value
          "
          (click)="resetFilter()"
        >
          <mat-icon>clear</mat-icon> {{ "Clear" | translate }}
        </button>
      </form>
    </div>
    <app-create-report-button></app-create-report-button>
  </div>

  <div class="table__page">
    <mat-table mat-table [dataSource]="dataSource">
      <ng-container matColumnDef="dealId">
        <mat-header-cell *matHeaderCellDef>
          {{ "No." | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.dealId }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <!-- matSort -->
      <!-- (matSortChange)="announceSortChange($event)" -->
      <!-- Report name Column -->
      <ng-container matColumnDef="dealType">
        <mat-header-cell *matHeaderCellDef>
          <!-- mat-sort-header
          sortActionDescription="Sort by Report name" -->
          {{ "ReportName" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.dealType | translate }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="participant">
        <mat-header-cell *matHeaderCellDef>
          {{ "Participant" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.participant }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="partner">
        <mat-header-cell *matHeaderCellDef>
          {{ "Partner" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.partner }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="isocode">
        <mat-header-cell *matHeaderCellDef>
          {{ "CurrencyISOCode" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.isocode }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="volume">
        <mat-header-cell *matHeaderCellDef>
          {{ "Volume" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.volume }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="rate">
        <mat-header-cell *matHeaderCellDef>
          {{ "Rate" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.rate }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <!-- Date/Time Column -->
      <ng-container matColumnDef="dealDate">
        <mat-header-cell *matHeaderCellDef>
          <!-- mat-sort-header
          sortActionDescription="Sort by Date/Time" -->
          {{ "DateTime" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          {{ element.dealDate | date : "dd/MM/yyyy hh:mm" }}
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="calculationDate">
        <mat-header-cell *matHeaderCellDef>
          {{ "CalculationDate" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{
                element.calculationDate
                  ? (element.calculationDate | date : "dd/MM/yyyy")
                  : "--"
              }}
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <mat-header-cell *matHeaderCellDef>
          <!-- mat-sort-header
          sortActionDescription="Sort by status" -->
          {{ "Status" | translate }}
        </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="tableRow">
            <div class="tableRow__header">
              {{ element.status | translate }}
            </div>
            <div class="tableRow__icons is-flex">
              <button
                (click)="edit(element)"
                mat-icon-button
                aria-label="Edit report"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <!-- <button
                (click)="downloadXLS(element)"
                mat-icon-button
                aria-label="Download report as XLS"
              >
                <mat-icon>save_alt</mat-icon>
              </button>
              <button
                (click)="downloadPDF(element)"
                mat-icon-button
                aria-label="Download report as PDF"
              >
                <mat-icon>picture_as_pdf</mat-icon>
              </button> -->
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
    </mat-table>

    <mat-paginator
      #paginator
      (page)="onPageEvent($event)"
      [length]="totalData"
      [pageSizeOptions]="pageSizes"
      showFirstLastButtons
    ></mat-paginator>
  </div>
</div>
